# 技术架构分析

## 整体架构

### 1. 应用架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端管理界面   │    │   Strapi API    │    │   数据库层      │
│   (React 18)    │◄──►│   (Node.js)     │◄──►│ (SQLite/MySQL/  │
│                 │    │                 │    │  PostgreSQL)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 2. 核心组件

#### 2.1 服务器配置 (`config/server.ts`)
- **主机**: 0.0.0.0 (默认)
- **端口**: 1337 (默认)
- **应用密钥**: 通过环境变量 `APP_KEYS` 配置

#### 2.2 数据库配置 (`config/database.ts`)
支持三种数据库类型：

**SQLite (默认)**
```typescript
sqlite: {
  connection: {
    filename: path.join(__dirname, '..', '..', env('DATABASE_FILENAME', '.tmp/data.db')),
  },
  useNullAsDefault: true,
}
```

**MySQL**
```typescript
mysql: {
  connection: {
    host: env('DATABASE_HOST', 'localhost'),
    port: env.int('DATABASE_PORT', 3306),
    database: env('DATABASE_NAME', 'strapi'),
    user: env('DATABASE_USERNAME', 'strapi'),
    password: env('DATABASE_PASSWORD', 'strapi'),
    ssl: env.bool('DATABASE_SSL', false)
  },
  pool: { min: 2, max: 10 }
}
```

**PostgreSQL**
```typescript
postgres: {
  connection: {
    host: env('DATABASE_HOST', 'localhost'),
    port: env.int('DATABASE_PORT', 5432),
    database: env('DATABASE_NAME', 'strapi'),
    user: env('DATABASE_USERNAME', 'strapi'),
    password: env('DATABASE_PASSWORD', 'strapi'),
    ssl: env.bool('DATABASE_SSL', false),
    schema: env('DATABASE_SCHEMA', 'public')
  },
  pool: { min: 2, max: 10 }
}
```

#### 2.3 API 配置 (`config/api.ts`)
- **默认限制**: 25 条记录
- **最大限制**: 100 条记录
- **计数功能**: 启用

#### 2.4 管理后台配置 (`config/admin.ts`)
- **JWT 密钥**: 通过环境变量 `ADMIN_JWT_SECRET` 配置
- **API Token 盐值**: 通过环境变量 `API_TOKEN_SALT` 配置
- **传输令牌盐值**: 通过环境变量 `TRANSFER_TOKEN_SALT` 配置
- **加密密钥**: 通过环境变量 `ENCRYPTION_KEY` 配置

### 3. 中间件配置 (`config/middlewares.ts`)
默认启用的中间件：
1. `strapi::logger` - 日志记录
2. `strapi::errors` - 错误处理
3. `strapi::security` - 安全防护
4. `strapi::cors` - 跨域资源共享
5. `strapi::poweredBy` - 响应头信息
6. `strapi::query` - 查询参数处理
7. `strapi::body` - 请求体解析
8. `strapi::session` - 会话管理
9. `strapi::favicon` - 网站图标
10. `strapi::public` - 静态文件服务

### 4. 插件配置 (`config/plugins.ts`)
当前为空配置，可根据需要添加插件。

## 数据模型

### 1. 内置内容类型
项目包含以下内置内容类型（基于 `types/generated/contentTypes.d.ts`）：

#### 1.1 管理员相关
- `AdminApiToken` - API 令牌
- `AdminApiTokenPermission` - API 令牌权限
- `AdminPermission` - 权限
- `AdminRole` - 角色
- `AdminSession` - 会话
- `AdminTransferToken` - 传输令牌
- `AdminTransferTokenPermission` - 传输令牌权限
- `AdminUser` - 管理员用户

#### 1.2 内容发布相关
- `PluginContentReleasesRelease` - 内容发布
- `PluginContentReleasesReleaseAction` - 发布操作

#### 1.3 国际化相关
- `PluginI18NLocale` - 语言环境

#### 1.4 工作流相关
- `PluginReviewWorkflowsWorkflow` - 工作流
- `PluginReviewWorkflowsWorkflowStage` - 工作流阶段

#### 1.5 文件管理相关
- `PluginUploadFile` - 文件
- `PluginUploadFolder` - 文件夹

#### 1.6 用户权限相关
- `PluginUsersPermissionsPermission` - 用户权限
- `PluginUsersPermissionsRole` - 用户角色
- `PluginUsersPermissionsUser` - 用户

## 开发环境

### 1. TypeScript 配置
- **目标版本**: ES2019
- **模块系统**: CommonJS
- **严格模式**: 关闭
- **输出目录**: `dist/`
- **根目录**: `.`

### 2. 构建配置
- **开发命令**: `npm run develop`
- **生产启动**: `npm run start`
- **构建命令**: `npm run build`
- **部署命令**: `npm run deploy`

## 安全特性

### 1. 认证与授权
- JWT 令牌认证
- 基于角色的访问控制 (RBAC)
- API 令牌管理
- 传输令牌支持

### 2. 数据安全
- 密码加密存储
- SSL/TLS 支持
- 会话管理
- 权限验证

### 3. 输入验证
- 请求体大小限制
- 查询参数验证
- 文件上传限制
- CORS 配置
```

## 3. 配置详解文档

```markdown:/Users/yinglian/webproject/node/tool-site-content/docs/配置详解.md
# 配置详解

## 环境变量配置

### 必需的环境变量

#### 应用配置
```bash
# 应用密钥 (必需)
APP_KEYS=your-app-keys-here

# 管理员 JWT 密钥 (必需)
ADMIN_JWT_SECRET=your-admin-jwt-secret

# API 令牌盐值 (必需)
API_TOKEN_SALT=your-api-token-salt

# 传输令牌盐值 (必需)
TRANSFER_TOKEN_SALT=your-transfer-token-salt

# 加密密钥 (必需)
ENCRYPTION_KEY=your-encryption-key
```

#### 数据库配置 (SQLite - 默认)
```bash
# 数据库客户端
DATABASE_CLIENT=sqlite

# 数据库文件路径
DATABASE_FILENAME=.tmp/data.db
```

#### 数据库配置 (MySQL)
```bash
DATABASE_CLIENT=mysql
DATABASE_HOST=localhost
DATABASE_PORT=3306
DATABASE_NAME=strapi
DATABASE_USERNAME=strapi
DATABASE_PASSWORD=strapi
DATABASE_SSL=false
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
```

#### 数据库配置 (PostgreSQL)
```bash
DATABASE_CLIENT=postgres
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=strapi
DATABASE_USERNAME=strapi
DATABASE_PASSWORD=strapi
DATABASE_SSL=false
DATABASE_SCHEMA=public
```

#### 服务器配置
```bash
# 服务器主机 (可选，默认: 0.0.0.0)
HOST=0.0.0.0

# 服务器端口 (可选，默认: 1337)
PORT=1337
```

### 可选的环境变量

#### 功能标志
```bash
# 启用 NPS 调查 (默认: true)
FLAG_NPS=true

# 推广企业版功能 (默认: true)
FLAG_PROMOTE_EE=true
```

## 配置文件详解

### 1. 服务器配置 (`config/server.ts`)

```typescript
export default ({ env }) => ({
  host: env('HOST', '0.0.0.0'),        // 服务器监听地址
  port: env.int('PORT', 1337),         // 服务器端口
  app: {
    keys: env.array('APP_KEYS'),       // 应用密钥数组
  },
});
```

**说明**:
- `host`: 服务器绑定的网络接口，`0.0.0.0` 表示监听所有接口
- `port`: 服务器端口号，默认 1337
- `app.keys`: 用于加密会话和应用数据的密钥数组

### 2. 数据库配置 (`config/database.ts`)

#### 连接配置
```typescript
export default ({ env }) => {
  const client = env('DATABASE_CLIENT', 'sqlite');
  
  return {
    connection: {
      client,                           // 数据库客户端类型
      ...connections[client],           // 对应的连接配置
      acquireConnectionTimeout: env.int('DATABASE_CONNECTION_TIMEOUT', 60000), // 连接超时时间
    },
  };
};
```

#### 连接池配置
```typescript
pool: { 
  min: env.int('DATABASE_POOL_MIN', 2),    // 最小连接数
  max: env.int('DATABASE_POOL_MAX', 10)    // 最大连接数
}
```

### 3. API 配置 (`config/api.ts`)

```typescript
export default {
  rest: {
    defaultLimit: 25,      // 默认返回记录数
    maxLimit: 100,         // 最大返回记录数
    withCount: true,       // 是否返回总数
  },
};
```

**说明**:
- `defaultLimit`: API 默认返回的记录数量
- `maxLimit`: API 最大可返回的记录数量
- `withCount`: 是否在响应中包含总记录数

### 4. 管理后台配置 (`config/admin.ts`)

```typescript
export default ({ env }) => ({
  auth: {
    secret: env('ADMIN_JWT_SECRET'),    // JWT 签名密钥
  },
  apiToken: {
    salt: env('API_TOKEN_SALT'),        // API 令牌盐值
  },
  transfer: {
    token: {
      salt: env('TRANSFER_TOKEN_SALT'), // 传输令牌盐值
    },
  },
  secrets: {
    encryptionKey: env('ENCRYPTION_KEY'), // 数据加密密钥
  },
  flags: {
    nps: env.bool('FLAG_NPS', true),           // NPS 调查标志
    promoteEE: env.bool('FLAG_PROMOTE_EE', true), // 企业版推广标志
  },
});
```

### 5. 中间件配置 (`config/middlewares.ts`)

```typescript
export default [
  'strapi::logger',        // 日志记录中间件
  'strapi::errors',        // 错误处理中间件
  'strapi::security',      // 安全中间件
  'strapi::cors',          // CORS 中间件
  'strapi::poweredBy',     // 响应头中间件
  'strapi::query',         // 查询参数中间件
  'strapi::body',          // 请求体解析中间件
  'strapi::session',       // 会话中间件
  'strapi::favicon',       // 网站图标中间件
  'strapi::public',        // 静态文件中间件
];
```

**中间件执行顺序**:
1. 日志记录
2. 错误处理
3. 安全防护
4. CORS 处理
5. 响应头设置
6. 查询参数处理
7. 请求体解析
8. 会话管理
9. 网站图标处理
10. 静态文件服务

## 部署配置

### 1. 开发环境
```bash
npm run develop
```

### 2. 生产环境
```bash
npm run build
npm run start
```

### 3. 部署到 Strapi Cloud
```bash
npm run deploy
```

## 安全建议

### 1. 环境变量安全
- 使用强密码和随机字符串
- 定期轮换密钥
- 不要在代码中硬编码敏感信息
- 使用 `.env` 文件管理本地环境变量

### 2. 数据库安全
- 启用 SSL 连接（生产环境）
- 使用专用数据库用户
- 限制数据库访问权限
- 定期备份数据

### 3. 网络安全
- 配置防火墙规则
- 使用 HTTPS
- 设置适当的 CORS 策略
- 启用安全中间件

## 性能优化

### 1. 数据库优化
- 配置合适的连接池大小
- 添加数据库索引
- 定期清理无用数据

### 2. 缓存策略
- 启用 Redis 缓存（可选）
- 配置静态资源缓存
- 使用 CDN 加速

### 3. 监控和日志
- 配置应用监控
- 设置日志级别
- 监控性能指标
```

## 4. 开发指南文档

```markdown:/Users/yinglian/webproject/node/tool-site-content/docs/开发指南.md
# 开发指南

## 项目设置

### 1. 环境要求
- Node.js 18.x - 22.x
- npm 6.0.0+
- 数据库 (SQLite/MySQL/PostgreSQL)

### 2. 安装依赖
```bash
npm install
```

### 3. 环境配置
创建 `.env` 文件：
```bash
# 复制环境变量模板
cp .env.example .env

# 编辑环境变量
nano .env
```

### 4. 启动开发服务器
```bash
npm run develop
```

## 项目结构说明

### 1. 源代码目录 (`src/`)

#### 1.1 应用入口 (`src/index.ts`)
```typescript
export default {
  register(/* { strapi }: { strapi: Core.Strapi } */) {
    // 注册阶段：扩展代码
  },
  bootstrap(/* { strapi }: { strapi: Core.Strapi } */) {
    // 启动阶段：设置数据模型、运行任务等
  },
};
```

#### 1.2 API 目录 (`src/api/`)
用于定义自定义 API 接口和内容类型。

#### 1.3 扩展目录 (`src/extensions/`)
用于扩展 Strapi 核心功能。

#### 1.4 管理后台 (`src/admin/`)
- `app.example.tsx` - 管理后台应用示例
- `tsconfig.json` - TypeScript 配置
- `vite.config.example.ts` - Vite 构建配置示例

### 2. 配置目录 (`config/`)

#### 2.1 服务器配置
- `server.ts` - 服务器基本配置
- `database.ts` - 数据库连接配置
- `api.ts` - API 相关配置
- `admin.ts` - 管理后台配置
- `middlewares.ts` - 中间件配置
- `plugins.ts` - 插件配置

### 3. 类型定义 (`types/`)

#### 3.1 生成类型 (`types/generated/`)
- `contentTypes.d.ts` - 内容类型定义
- `components.d.ts` - 组件类型定义

## 开发工作流

### 1. 创建内容类型

#### 1.1 使用 Strapi CLI
```bash
# 创建新的内容类型
npx strapi generate content-type

# 或者使用交互式命令
npx strapi generate
```

#### 1.2 手动创建
在 `src/api/` 目录下创建新的 API 文件夹：
```
src/api/
└── article/
    ├── content-types/
    │   └── article/
    │       └── schema.json
    ├── controllers/
    │   └── article.js
    ├── routes/
    │   └── article.js
    └── services/
        └── article.js
```

### 2. 自定义 API 控制器

#### 2.1 创建控制器 (`src/api/article/controllers/article.js`)
```javascript
'use strict';

module.exports = {
  async find(ctx) {
    // 自定义查找逻辑
    const { data, meta } = await super.find(ctx);
    
    // 添加自定义处理
    return { data, meta };
  },

  async findOne(ctx) {
    // 自定义单个查找逻辑
    return super.findOne(ctx);
  },

  async create(ctx) {
    // 自定义创建逻辑
    return super.create(ctx);
  },

  async update(ctx) {
    // 自定义更新逻辑
    return super.update(ctx);
  },

  async delete(ctx) {
    // 自定义删除逻辑
    return super.delete(ctx);
  },
};
```

### 3. 自定义服务

#### 3.1 创建服务 (`src/api/article/services/article.js`)
```javascript
'use strict';

module.exports = ({ strapi }) => ({
  async customMethod(params) {
    // 自定义业务逻辑
    return await strapi.entityService.findMany('api::article.article', {
      ...params,
    });
  },
});
```

### 4. 自定义路由

#### 4.1 创建路由 (`src/api/article/routes/article.js`)
```javascript
'use strict';

module.exports = {
  routes: [
    {
      method: 'GET',
      path: '/articles/custom',
      handler: 'article.customAction',
      config: {
        policies: [],
        middlewares: [],
      },
    },
  ],
};
```

### 5. 中间件开发

#### 5.1 创建自定义中间件
```javascript
// src/middlewares/custom-middleware.js
module.exports = (config, { strapi }) => {
  return async (ctx, next) => {
    // 中间件逻辑
    console.log('Custom middleware executed');
    await next();
  };
};
```

#### 5.2 注册中间件 (`config/middlewares.ts`)
```typescript
export default [
  'strapi::logger',
  'strapi::errors',
  'strapi::security',
  'strapi::cors',
  'strapi::poweredBy',
  'strapi::query',
  'strapi::body',
  'strapi::session',
  'strapi::favicon',
  'strapi::public',
  'global::custom-middleware', // 添加自定义中间件
];
```

### 6. 插件开发

#### 6.1 创建插件目录结构
```
src/plugins/
└── my-plugin/
    ├── admin/
    │   └── src/
    │       └── index.js
    ├── server/
    │   ├── controllers/
    │   ├── services/
    │   ├── routes/
    │   └── index.js
    └── package.json
```

#### 6.2 插件配置 (`config/plugins.ts`)
```typescript
export default () => ({
  'my-plugin': {
    enabled: true,
    config: {
      // 插件配置
    },
  },
});
```

## 数据库操作

### 1. 使用 Entity Service API

#### 1.1 查找数据
```javascript
// 查找所有文章
const articles = await strapi.entityService.findMany('api::article.article', {
  populate: ['author', 'category'],
  filters: {
    publishedAt: { $notNull: true },
  },
  sort: { createdAt: 'desc' },
  pagination: {
    page: 1,
    pageSize: 10,
  },
});

// 查找单个文章
const article = await strapi.entityService.findOne('api::article.article', 1, {
  populate: ['author', 'category'],
});
```

#### 1.2 创建数据
```javascript
const article = await strapi.entityService.create('api::article.article', {
  data: {
    title: '新文章',
    content: '文章内容',
    author: 1,
    publishedAt: new Date(),
  },
});
```

#### 1.3 更新数据
```javascript
const updatedArticle = await strapi.entityService.update('api::article.article', 1, {
  data: {
    title: '更新的标题',
  },
});
```

#### 1.4 删除数据
```javascript
await strapi.entityService.delete('api::article.article', 1);
```

### 2. 数据库迁移

#### 2.1 创建迁移文件
```bash
npx strapi database:migration:create add-new-field
```

#### 2.2 编写迁移逻辑
```javascript
// database/migrations/20231201000000-add-new-field.js
module.exports = {
  async up(knex) {
    await knex.schema.alterTable('articles', (table) => {
      table.string('new_field');
    });
  },

  async down(knex) {
    await knex.schema.alterTable('articles', (table) => {
      table.dropColumn('new_field');
    });
  },
};
```

## 测试

### 1. 单元测试
```javascript
// tests/unit/article.test.js
describe('Article Service', () => {
  test('should create article', async () => {
    const articleData = {
      title: 'Test Article',
      content: 'Test Content',
    };
    
    const article = await strapi.entityService.create('api::article.article', {
      data: articleData,
    });
    
    expect(article.title).toBe(articleData.title);
  });
});
```

### 2. 集成测试
```javascript
// tests/integration/api.test.js
describe('Article API', () => {
  test('GET /api/articles should return articles', async () => {
    const response = await request(app)
      .get('/api/articles')
      .expect(200);
    
    expect(response.body.data).toBeDefined();
  });
});
```

## 调试

### 1. 日志记录
```javascript
// 在代码中添加日志
strapi.log.info('Info message');
strapi.log.warn('Warning message');
strapi.log.error('Error message');
strapi.log.debug('Debug message');
```

### 2. 调试模式
```bash
# 启用调试模式
DEBUG=strapi:* npm run develop
```

### 3. 数据库查询调试
```javascript
// 启用数据库查询日志
const query = await strapi.db.query('api::article.article').findMany({
  where: { id: 1 },
  populate: ['author'],
});

console.log('Generated SQL:', query.toSQL());
```

## 部署

### 1. 构建项目
```bash
npm run build
```

### 2. 生产环境启动
```bash
NODE_ENV=production npm run start
```

### 3. 环境变量配置
确保生产环境配置了所有必需的环境变量：
- `APP_KEYS`
- `ADMIN_JWT_SECRET`
- `API_TOKEN_SALT`
- `TRANSFER_TOKEN_SALT`
- `ENCRYPTION_KEY`
- 数据库连接信息

## 最佳实践

### 1. 代码组织
- 保持控制器简洁，将业务逻辑放在服务中
- 使用中间件处理横切关注点
- 遵循单一职责原则

### 2. 性能优化
- 合理使用 populate 选项
- 实现分页查询
- 使用缓存机制

### 3. 安全考虑
- 验证所有输入数据
- 使用适当的权限控制
- 定期更新依赖包

### 4. 错误处理
- 实现全局错误处理
- 记录详细的错误日志
- 提供有意义的错误消息
```

## 5. API 文档

```markdown:/Users/yinglian/webproject/node/tool-site-content/docs/API文档.md
# API 文档

## 概述

本项目基于 Strapi 5.25.0 构建，提供完整的 RESTful API 接口。API 支持内容管理、用户认证、文件上传等核心功能。

## 基础信息

- **Base URL**: `http://localhost:1337/api`
- **Content-Type**: `application/json`
- **认证方式**: JWT Token / API Token

## 认证

### 1. JWT 认证

#### 管理员登录
```http
POST /admin/auth/local
Content-Type: application/json

{
  "identifier": "admin@example.com",
  "password": "password"
}
```

**响应**:
```json
{
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "email": "admin@example.com",
      "username": "admin"
    }
  }
}
```

#### 使用 JWT Token
```http
GET /api/articles
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### 2. API Token 认证

#### 使用 API Token
```http
GET /api/articles
Authorization: Bearer your-api-token
```

## 内容管理 API

### 1. 文章管理 (示例)

#### 获取文章列表
```http
GET /api/articles
```

**查询参数**:
- `filters` - 过滤条件
- `populate` - 关联数据
- `sort` - 排序
- `pagination[page]` - 页码
- `pagination[pageSize]` - 每页数量

**示例**:
```http
GET /api/articles?filters[title][$contains]=strapi&populate=author&sort=createdAt:desc&pagination[page]=1&pagination[pageSize]=10
```

**响应**:
```json
{
  "data": [
    {
      "id": 1,
      "attributes": {
        "title": "文章标题",
        "content": "文章内容",
        "publishedAt": "2023-12-01T00:00:00.000Z",
        "createdAt": "2023-12-01T00:00:00.000Z",
        "updatedAt": "2023-12-01T00:00:00.000Z",
        "author": {
          "data": {
            "id": 1,
            "attributes": {
              "name": "作者姓名"
            }
          }
        }
      }
    }
  ],
  "meta": {
    "pagination": {
      "page": 1,
      "pageSize": 10,
      "pageCount": 5,
      "total": 50
    }
  }
}
```

#### 获取单个文章
```http
GET /api/articles/{id}
```

**响应**:
```json
{
  "data": {
    "id": 1,
    "attributes": {
      "title": "文章标题",
      "content": "文章内容",
      "publishedAt": "2023-12-01T00:00:00.000Z",
      "createdAt": "2023-12-01T00:00:00.000Z",
      "updatedAt": "2023-12-01T00:00:00.000Z"
    }
  }
}
```

#### 创建文章
```http
POST /api/articles
Content-Type: application/json
Authorization: Bearer {token}

{
  "data": {
    "title": "新文章标题",
    "content": "新文章内容",
    "publishedAt": "2023-12-01T00:00:00.000Z"
  }
}
```

**响应**:
```json
{
  "data": {
    "id": 2,
    "attributes": {
      "title": "新文章标题",
      "content": "新文章内容",
      "publishedAt": "2023-12-01T00:00:00.000Z",
      "createdAt": "2023-12-01T00:00:00.000Z",
      "updatedAt": "2023-12-01T00:00:00.000Z"
    }
  }
}
```

#### 更新文章
```http
PUT /api/articles/{id}
Content-Type: application/json
Authorization: Bearer {token}

{
  "data": {
    "title": "更新的标题",
    "content": "更新的内容"
  }
}
```

#### 删除文章
```http
DELETE /api/articles/{id}
Authorization: Bearer {token}
```

**响应**:
```json
{
  "data": {
    "id": 1,
    "attributes": {
      "title": "文章标题",
      "content": "文章内容"
    }
  }
}
```

## 用户权限 API

### 1. 用户注册
```http
POST /api/auth/local/register
Content-Type: application/json

{
  "username": "newuser",
  "email": "user@example.com",
  "password": "password123"
}
```

### 2. 用户登录
```http
POST /api/auth/local
Content-Type: application/json

{
  "identifier": "user@example.com",
  "password": "password123"
}
```

### 3. 获取用户信息
```http
GET /api/users/me
Authorization: Bearer {token}
```

### 4. 更新用户信息
```http
PUT /api/users/me
Content-Type: application/json
Authorization: Bearer {token}

{
  "username": "newusername",
  "email": "newemail@example.com"
}
```

## 文件上传 API

### 1. 上传文件
```http
POST /api/upload
Content-Type: multipart/form-data
Authorization: Bearer {token}

file: [binary data]
```

**响应**:
```json
{
  "data": [
    {
      "id": 1,
      "attributes": {
        "name": "example.jpg",
        "alternativeText": null,
        "caption": null,
        "width": 1920,
        "height": 1080,
        "formats": {
          "thumbnail": {
            "name": "thumbnail_example.jpg",
            "hash": "thumbnail_example_1234567890",
            "ext": ".jpg",
            "mime": "image/jpeg",
            "width": 156,
            "height": 88,
            "size": 4.05,
            "url": "/uploads/thumbnail_example_1234567890.jpg"
          }
        },
        "hash": "example_1234567890",
        "ext": ".jpg",
        "mime": "image/jpeg",
        "size": 95.9,
        "url": "/uploads/example_1234567890.jpg",
        "previewUrl": null,
        "provider": "local",
        "provider_metadata": null,
        "createdAt": "2023-12-01T00:00:00.000Z",
        "updatedAt": "2023-12-01T00:00:00.000Z"
      }
    }
  ]
}
```

### 2. 获取文件信息
```http
GET /api/upload/files/{id}
```

### 3. 删除文件
```http
DELETE /api/upload/files/{id}
Authorization: Bearer {token}
```

## 查询参数

### 1. 过滤 (Filters)

#### 基础过滤
```http
GET /api/articles?filters[title][$eq]=Strapi
GET /api/articles?filters[title][$ne]=Strapi
GET /api/articles?filters[title][$contains]=strapi
GET /api/articles?filters[title][$containsi]=strapi
GET /api/articles?filters[title][$startsWith]=Strapi
GET /api/articles?filters[title][$endsWith]=tutorial
```

#### 数值过滤
```http
GET /api/articles?filters[views][$gt]=100
GET /api/articles?filters[views][$gte]=100
GET /api/articles?filters[views][$lt]=1000
GET /api/articles?filters[views][$lte]=1000
```

#### 日期过滤
```http
GET /api/articles?filters[createdAt][$gte]=2023-01-01
GET /api/articles?filters[createdAt][$lte]=2023-12-31
```

#### 关联过滤
```http
GET /api/articles?filters[author][name][$eq]=John
GET /api/articles?filters[category][id][$eq]=1
```

#### 逻辑操作符
```http
GET /api/articles?filters[$or][0][title][$contains]=strapi&filters[$or][1][content][$contains]=tutorial
GET /api/articles?filters[$and][0][publishedAt][$notNull]=true&filters[$and][1][views][$gt]=100
```

### 2. 排序 (Sort)

```http
GET /api/articles?sort=title:asc
GET /api/articles?sort=createdAt:desc
GET /api/articles?sort[0]=title:asc&sort[1]=createdAt:desc
```

### 3. 分页 (Pagination)

```http
GET /api/articles?pagination[page]=1&pagination[pageSize]=10
GET /api/articles?pagination[pageSize]=25&pagination[withCount]=true
```

### 4. 关联数据 (Populate)

```http
GET /api/articles?populate=author
GET /api/articles?populate[0]=author&populate[1]=category
GET /api/articles?populate[author][populate][0]=profile
```

### 5. 字段选择 (Fields)

```http
GET /api/articles?fields[0]=title&fields[1]=content
```

## 错误处理

### 1. 错误响应格式
```json
{
  "data": null,
  "error": {
    "status": 400,
    "name": "ValidationError",
    "message": "Invalid input data",
    "details": {
      "errors": [
        {
          "path": ["title"],
          "message": "title is required",
          "name": "ValidationError"
        }
      ]
    }
  }
}
```

### 2. 常见错误码
- `400` - 请求参数错误
- `401` - 未授权
- `403` - 禁止访问
- `404` - 资源不存在
- `422` - 数据验证失败
- `500` - 服务器内部错误

## 速率限制

API 请求受到以下限制：
- 默认限制：25 条记录/请求
- 最大限制：100 条记录/请求
- 请求频率限制：根据配置而定

## 示例代码

### JavaScript (Fetch)
```javascript
// 获取文章列表
const response = await fetch('http://localhost:1337/api/articles', {
  headers: {
    'Authorization': 'Bearer your-token',
    'Content-Type': 'application/json'
  }
});
const data = await response.json();

// 创建文章
const newArticle = await fetch('http://localhost:1337/api/articles', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer your-token',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    data: {
      title: '新文章',
      content: '文章内容'
    }
  })
});
```

### cURL
```bash
# 获取文章列表
curl -X GET "http://localhost:1337/api/articles" \
  -H "Authorization: Bearer your-token"

# 创建文章
curl -X POST "http://localhost:1337/api/articles" \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{"data":{"title":"新文章","content":"文章内容"}}'
```

### Python (requests)
```python
import requests

# 获取文章列表
response = requests.get(
    'http://localhost:1337/api/articles',
    headers={'Authorization': 'Bearer your-token'}
)
data = response.json()

# 创建文章
new_article = requests.post(
    'http://localhost:1337/api/articles',
    headers={
        'Authorization': 'Bearer your-token',
        'Content-Type': 'application/json'
    },
    json={
        'data': {
            'title': '新文章',
            'content': '文章内容'
        }
    }
)
```
```

## 项目分析总结

这是一个基于 **Strapi 5.25.0** 的内容管理系统项目，具有以下特点：

### 🏗️ **项目架构**
- **后端框架**: Strapi 5.25.0 (Node.js)
- **前端技术**: React 18 + TypeScript
- **数据库支持**: SQLite (默认)、MySQL、PostgreSQL
- **开发语言**: TypeScript 5.x

### 📁 **项目状态**
- ✅ 基础配置完整
- ✅ 依赖安装完成
- ✅ TypeScript 配置就绪
- ⚠️ 尚未创建自定义内容类型
- ⚠️ 数据库迁移文件为空
- ⚠️ 扩展功能待开发

### 🔧 **核心功能**
1. **内容管理**: 基于 Strapi 的 CMS 功能
2. **用户权限**: 完整的 RBAC 权限系统
3. **文件管理**: 支持文件上传和管理
4. **多语言支持**: 内置国际化功能
5. **API 接口**: 自动生成的 RESTful API

### 📋 **已创建的文档**
1. **项目概览** - 项目基本信息和结构
2. **技术架构** - 详细的技术架构分析
3. **配置详解** - 环境变量和配置文件说明
4. **开发指南** - 完整的开发工作流程
5. **API 文档** - RESTful API 使用说明

所有文档已保存在 `docs/` 目录下，为项目的后续开发提供了完整的参考指南。项目目前处于初始阶段，具备了良好的基础架构，可以开始进行内容类型定义和功能开发。
